<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8" import="java.sql.*"%>
<!DOCTYPE html>
<html>
<head>
<title>Insert title here</title>
<script>
 function del(id){
	 	result = confirm("정말 삭제하시겠습니까?");
	 	if(result==true)
		location.href="addr_remove.jsp?id="+id;
	 }

 function check(){
		with(document.addrForm){
			if(name.value.length == 0){
				alert("이름은 반드시 입력해야 합니다.");
				name.focus();
				return false;
				}
			if(phonenum.value.length == 0){
				alert("전화번호는 반드시 입력해야 합니다.");
				phonenum.focus();
				return false;
				}
			if(birthday.value.length == 0){
				alert("생일은 반드시 입력해야 합니다.");
				birth.focus();
				return false;
				}
			document.addrForm.submit();			
			}
		}
</script>
</head>
<%
	String id=request.getParameter("id");
	String name="";
	String phonenum="";
	String birthday="";
	String company="";
	String memo="";
	String email="";
	String pass=request.getParameter("pass");
	
	if(!(pass.equals("1234")))
		out.println("<script>alert('비밀번호가 일치하지 않습니다.');history.go(-1);</script>");
	
	Connection con = null;
	PreparedStatement pstmt = null;
	ResultSet rs = null;
	String sql="";
	
	try{
		Class.forName("com.mysql.jdbc.Driver");
	}catch(ClassNotFoundException e){ 
		e.printStackTrace();
	}
	
	try{
		con = DriverManager.getConnection("jdbc:mysql://localhost:3306/addr","hkitJeongwon","gj0123");
	}catch(SQLException e){
		e.printStackTrace();
	}
	
	try{
		sql="select * from addrbook where id=?";
		pstmt=con.prepareStatement(sql);
		pstmt.setString(1, id);
		rs=pstmt.executeQuery();
		rs.next();
		name=rs.getString(2);
		email=rs.getString(3);
		phonenum=rs.getString(4);
		birthday=rs.getString(5);
		company=rs.getString(6);
		memo=rs.getString(7);
	}catch(SQLException e){
		e.printStackTrace();
	}
%>

<body>

	<center>
		<h1>주소록:등록화면</h1>
		<hr>
		<a href="list.jsp">주소록 등록</a><br>
		<br>
		<form name="addrForm" method="get" action="addr_insert_save.jsp">
			<table width="500" border='0' style="text-align:center;background-color:#7ec6ef;color:white">
	
			<tr>
				<th>이름</th>
				<td align="left"><input type="text" name="name" value=<%=name %>></td>
			</tr>
			<tr>
				<th>e-mail</th>
				<td align="left"><input type="text" name="email" value=<%=email %> ></td>
			</tr>
			<tr>
				<th>전화번호</th>
				<td align="left"><input type="text" name="phonenum" value=<%=phonenum %>></td>
			</tr>
			<tr>
				<th>생일</th>
				<td align="left"><input type="date" name="birthday" value=<%=birthday %>></td>
			</tr>
			<tr>
				<th>회사</th>
				<td align="left"><input type="text" name="company" value=<%=company %>></td>
			</tr>
			<tr>
				<th>메모</th>
				<td align="left"><input type="text" name="memo" value=<%=memo %>></td>
			</tr>
			<input type=hidden name="id" value=<%=id %>>
			<tr>
				<td><input type="button" value="저장" onClick="check();">
				<input type="reset" value="취소">
<%-- 				<input type="button" value="삭제" onClick="location.href='addr_remove.jsp?id=<%=id%>'"></td> --%>
				<input type="button" value="삭제" onClick="del(<%=id%>);"></td>
			</tr>
			

		</table>
	</form>
	</center>

</body>
</html>