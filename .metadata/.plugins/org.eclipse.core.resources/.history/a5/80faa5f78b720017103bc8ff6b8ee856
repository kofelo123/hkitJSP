<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8" errorPage="error.jsp" import="java.sql.*" %>
<%
	String userid = request.getParameter("userid");
	String query = new String();
	
	int check_count = 0;
	boolean bJoin = false;
	
	Connection conn = null;
	Statement stmt = null;
	ResultSet rs = null;
	
	try{
		Class.forName("com.mysql.jdbc.Driver");
	}catch(ClassNotFoundException e){
		out.println(e);
	}
	
	try{
		conn = DriverManager.getConnection("jdbc:mysql://localhost:3306/member","hkitJeongwon","gj0123");
		stmt = conn.createStatement();
		
		query="select count(*) as count from member where userid='" + userid + "'";
		rs=stmt.executeQuery(query);
		rs.next();
		check_count = rs.getInt("count");
		rs.close();
	}catch(SQLException e){
		
	}finally{
		conn.close();
	}
%>
<!DOCTYPE html>
<html>
<head>
<title>아이디 중복검사</title>

<script>

</script>
</head>
<body text="#000000" bgcolor="#FFFFFF" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<br/>
<br/>
<form name="id_check" method="post" action="userid_check.jsp">
	<input type="hidden" name="check_count" value="<%=check_count %>">
	<table width="300" border="0" cellspacing="0" cellpadding="0" align="center" class="style1">
		<tr>
			<td> 원하는 아이디를 입력하세요.</td>
		</tr>
	</table>
	<table width="300" border="0" bgcolor="#B6C1D6" height="39" align="center" class="style1">
		<tr>
			<td bgcolor="#ffffff" width="40%" align="center">
				<input type="text" name="userid" value="<%=userid%>" onFocus="this.value="" maxlength="16" size="16" class="input_style1">
				<input type="button" value="중복확인" onClick="doCheck()" class="input_style1">
			</td>
		</tr>
		<tr>
			<td>
			<%
				if(check_count > 0){
			%>
				[<%=userid %>]은 등록되어있는 아이디입니다.<br> 다시 시도해주십시오.
			<%
				}else{
			%>	
				[<%=userid %>]은 사용 가능합니다.
			<%
				}
			%>
			</td>
		</tr>
	</table>
	<table width="100%" border="0" cellspacing="0" cellpadding="0" align="center">
		<tr>
			<td align="center">
				<input type="button" value="확인" onClick="checkEnd()" class="style">
			</td>
	</table>
</form>

</body>
</html>